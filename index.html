<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="manifest" href="/manifest.json" />

    <meta name="theme-color" content="#0ea5e9" />
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="#0ea5e9" />
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#075985" />

    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'%3E%3Crect width='180' height='180' fill='%230ea5e9'/%3E%3Cpath d='M45 90L67.5 67.5L90 90L135 45L157.5 67.5L90 135L45 90Z' fill='white'/%3E%3C/svg%3E" />

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="MPB Dashboard" />

    <meta name="msapplication-TileColor" content="#0ea5e9" />

    <meta name="application-name" content="MPB Health CTO Dashboard" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="format-detection" content="telephone=no" />

    <title>MPB Health CTO Dashboard - Executive Technology Leadership</title>
    <meta name="description" content="Comprehensive executive dashboard for MPB Health's technology leadership team with analytics, project management, and organizational insights." />

    <script>
      (function() {
        const isStackBlitz = window.location.hostname.includes('stackblitz') ||
                            window.location.hostname.includes('webcontainer');

        const platformErrorPatterns = [
          'ad_conversions',
          'Tracking has already been taken',
          'sendAdConversions',
          'Contextify',
          'stackblitz.com/api'
        ];

        const isPlatformError = (message) => {
          return platformErrorPatterns.some(pattern =>
            String(message).toLowerCase().includes(pattern.toLowerCase())
          );
        };

        const originalConsoleError = console.error;
        console.error = function(...args) {
          if (isStackBlitz && args.some(arg => isPlatformError(arg))) {
            return;
          }
          originalConsoleError.apply(console, args);
        };

        window.addEventListener('error', (e) => {
          if (isStackBlitz && isPlatformError(e.message)) {
            e.preventDefault();
            return;
          }

          // Prevent logging errors from minified code initialization
          if (e.message && e.message.includes('before initialization')) {
            e.preventDefault();
            return;
          }

          if (!isStackBlitz || localStorage.getItem('debug') === 'true') {
            try {
              originalConsoleError.call(console, '[MPB Health] Global Error:', {
                message: e.message || 'Unknown error',
                filename: e.filename || 'Unknown',
                lineno: e.lineno || 0,
                colno: e.colno || 0
              });
            } catch (err) {
              // Prevent recursive error logging
            }
          }
        }, true);

        window.addEventListener('unhandledrejection', (e) => {
          if (isStackBlitz && isPlatformError(String(e.reason))) {
            e.preventDefault();
            return;
          }

          if (!isStackBlitz || localStorage.getItem('debug') === 'true') {
            console.error('[MPB Health] Unhandled Promise Rejection:', e.reason);
          }
        }, true);
      })();
    </script>
  </head>
  <body>
    <div id="root">
      <!-- Initial loading indicator - will be replaced when React mounts -->
      <div style="display: flex; align-items: center; justify-content: center; min-height: 100vh; background: #f8fafc; font-family: system-ui, sans-serif;">
        <div style="text-align: center;">
          <div style="width: 48px; height: 48px; border: 3px solid #e2e8f0; border-top-color: #ec4899; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 16px;"></div>
          <p style="color: #64748b; font-size: 14px;">Loading MPB Health Dashboard...</p>
          <p style="color: #94a3b8; font-size: 12px; margin-top: 8px;">If this persists, check console (F12)</p>
        </div>
      </div>
      <style>
        @keyframes spin {
          to { transform: rotate(360deg); }
        }
      </style>
    </div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
